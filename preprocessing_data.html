<!DOCTYPE HTML>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>Data Preprocessing</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">
	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<div class="inner">

				<!-- Logo -->
				<a href="index.html" class="logo">
					<span class="symbol"><img src="images/NeuroNestLogo.png" alt="NeuroNest Logo" /></span><span class="title">NeuroNest</span>
				</a>

				<!-- Nav -->
				<nav>
					<ul>
						<li><a href="#menu">Menu</a></li>
					</ul>
				</nav>

			</div>
		</header>

		<!-- Menu -->
		<nav id="menu">
			<h2>Menu</h2>
			<ul>
				<li><a href="index.html">Home</a></li>
				<li><a href="resource_menu.html">Resources</a></li>
				<li><a href="https://sopkoc.wixsite.com/neuronest/forum">Ask a Question</a></li>
				<li><a href="https://sopkoc.wixsite.com/neuronest/about">About NeuroNest</a></li>
				<li><a href="https://sopkoc.wixsite.com/neuronest/contact">Contact</a></li>
			</ul>
		</nav>

		<!-- Main -->
		<div id="main">
			<div class="inner">
				<h1>Data Preprocessing</h1>
				<span class="image main"><img src="images/Preprocess_banner.png" alt="" /></span>
				<p>Welcome to the NeuroNest tutorial on Data Preprocessing for Neuroimaging Data!</p>

				<h2>Tutorial Time: 40 min</h2>
				<p>In this tutorial, we'll cover several fundamental concepts essential for cleaning and preparing neuroimaging data for analysis. We will focus on MRI data, highlighting techniques, tools, and steps necessary to ensure high-quality data ready for in-depth analysis.</p>

				<h2>Steps in Data Preprocessing:</h2>

				<h3>1. Introduction to Data Preprocessing</h3>
				<p><strong>Importance:</strong> Understanding the need for cleaning and preparing neuroimaging data to ensure accurate and reliable analysis.</p>
				<p><strong>General Steps:</strong> Overview of typical preprocessing steps, including data cleaning, normalization, and transformation.</p>

				<h3>2. Techniques for Cleaning and Preparing Neuroimaging Data:</h3>
				<img src="images/preprocessing_flow.png" alt="Preprocessing Flow" style="width:100%; max-width:800px; margin-bottom:20px;">

				<p>Neuroimaging data preprocessing involves several critical steps to ensure that the data is clean, accurate, and ready for analysis. Below are the key techniques involved in this process:</p>

				<ul>
					<li><strong>Distortion Correction:</strong>
						<p>This step corrects distortions in the images caused by inhomogeneities in the magnetic field. These distortions can lead to geometric inaccuracies in the images, which are corrected to ensure that the brain structures are accurately represented.</p>
					</li>
					<li><strong>Motion Correction:</strong>
						<p>Motion correction addresses the issue of subject movement during scanning. This step realigns the images to minimize artifacts caused by head motion, ensuring that the data reflects true neural activity rather than movement artifacts.</p>
					</li>
					<li><strong>Slice Timing Correction:</strong>
						<p>During an fMRI scan, different slices of the brain are captured at slightly different times. Slice timing correction adjusts the data to account for these differences, aligning the temporal information across slices.</p>
					</li>
					<li><strong>Coregistration:</strong>
						<p>Coregistration involves aligning the functional images to the anatomical (structural) images. This step ensures that the functional data is accurately mapped onto the anatomical structure of the brain, allowing for precise localization of brain activity.</p>
					</li>
					<li><strong>Spatial Normalization:</strong>
						<p>Spatial normalization aligns the brain images of different subjects to a common brain template, such as the MNI template. This process allows for group analyses and comparisons across subjects by ensuring that the brain structures are in the same spatial coordinates.</p>
					</li>
					<li><strong>Smoothing:</strong>
						<p>Smoothing is the process of applying a Gaussian filter to the images to enhance the signal-to-noise ratio. This step reduces the impact of random noise and helps in detecting consistent patterns of brain activity across different subjects.</p>
					</li>
					<li><strong>Artifact Removal:</strong>
						<p>In addition to the above steps, artifact removal techniques are applied to identify and eliminate noise sources such as scanner noise or physiological artifacts (e.g., heartbeats, eye movements) to ensure that the data is as clean as possible for accurate analysis.</p>
					</li>
				</ul>

				<h3>3. Using FMRIPREP:</h3>
				<p><strong>Overview:</strong> FMRIPREP is a robust and reproducible preprocessing pipeline for functional MRI data.</p>
				<p><strong>Key Features:</strong> Automated preprocessing, standardized outputs, extensive reporting.</p>
				<p><strong>Steps in FMRIPREP Pipeline:</strong> Motion Correction, Spatial Normalization, Segmentation, Smoothing, Artifact Removal.</p>
				<p><strong>Advantages and Disadvantages:</strong> Reproducibility, automation, comprehensive reporting. Resource-intensive, complexity.</p>

				<h3>4. Quality Assessment with MRIQC:</h3>
				<p><strong>Overview:</strong> MRIQC is a tool designed to assess the quality of MRI data through various metrics and visual reports.</p>
				<p><strong>Key Features:</strong> Quality assessment, comprehensive metrics, easy-to-interpret reports.</p>
				<p><strong>Steps in MRIQC Pipeline:</strong> Image Assessment, Quality Metrics Calculation, Reporting.</p>

				<h3>5. Comparison of FMRIPREP and MRIQC:</h3>
				<p><strong>Purpose:</strong> FMRIPREP focuses on preprocessing functional MRI data to prepare it for analysis. MRIQC focuses on assessing the quality of MRI data to ensure high standards.</p>
				<p><strong>Functionality:</strong> FMRIPREP includes steps like motion correction, spatial normalization, segmentation, and artifact removal. MRIQC computes quality metrics and generates reports but does not preprocess the data.</p>
				<p><strong>Use Case:</strong> FMRIPREP is ideal for researchers needing a comprehensive and automated preprocessing solution. MRIQC is ideal for researchers needing to assess and ensure data quality before analysis.</p>
				<p><strong>Integration:</strong> MRIQC can be used before FMRIPREP to assess data quality and after FMRIPREP to evaluate preprocessing effectiveness.</p>

				<h3>Frequently Asked Questions (FAQ)</h3>
				<ul>
					<li><strong>Q1: Why is preprocessing necessary for neuroimaging data?</strong>
						<p>A: Preprocessing is essential to correct for artifacts, motion, and other inconsistencies in neuroimaging data. This ensures that the data accurately represents brain activity, allowing for reliable and valid analysis.</p>
					</li>
					<li><strong>Q2: What are the common steps involved in preprocessing neuroimaging data?</strong>
						<p>A: Common preprocessing steps include distortion correction, motion correction, slice timing correction, coregistration, spatial normalization, smoothing, and artifact removal.</p>
					</li>
					<li><strong>Q3: How does motion affect neuroimaging data?</strong>
						<p>A: Subject movement during scanning can cause significant artifacts, leading to misinterpretation of brain activity. Motion correction algorithms realign the images to mitigate these effects.</p>
					</li>
					<li><strong>Q4: What is spatial normalization, and why is it important?</strong>
						<p>A: Spatial normalization involves aligning individual brain images to a common template. This standardization is crucial for comparing data across subjects and performing group analyses.</p>
					</li>
					<li><strong>Q5: What tools are commonly used for preprocessing neuroimaging data?</strong>
						<p>A: Popular tools include FMRIPREP, SPM, FSL, AFNI, and ANTs. These tools provide comprehensive pipelines for various preprocessing steps.</p>
					</li>
				</ul>

				<h3>Practical Tips for New Users</h3>
				<ul>
					<li><strong>Tip 1: Understand Your Data</strong>
							<p>Before beginning preprocessing, familiarize yourself with the type of neuroimaging data you have (e.g., fMRI, DTI, EEG) and its specific requirements. Understanding your data will help you choose the appropriate preprocessing steps and tools.</p>
					</li>
					<li><strong>Tip 2: Start with High-Quality Data</strong>
							<p>Ensure that your raw data is of high quality. Good quality data minimizes the need for extensive correction and reduces the risk of introducing errors during preprocessing.</p>
					</li>
					<li><strong>Tip 3: Use Established Pipelines</strong>
							<p>Leverage established preprocessing pipelines like FMRIPREP. These pipelines are well-documented, widely used, and continuously updated to incorporate best practices and new developments in the field.</p>
					</li>
					<li><strong>Tip 4: Document Every Step</strong>
							<p>Keep detailed records of every preprocessing step you perform. Documentation ensures reproducibility and allows you to track any changes or corrections made to the data.</p>
					</li>
					<li><strong>Tip 5: Validate Your Results</strong>
							<p>After preprocessing, validate the results by visually inspecting the images and checking for expected outcomes. Tools like MRIQC can help assess the quality of your preprocessed data.</p>
					</li>
				</ul>

				<h3>Troubleshooting Tips</h3>
				<ul>
					<li><strong>Issue 1: Excessive Motion Artifacts</strong>
						<p><strong>Solution:</strong> If motion artifacts persist despite correction, consider using more advanced motion correction algorithms or excluding severely affected scans. Additionally, instruct subjects to remain as still as possible during scanning.</p>
					</li>
					<li><strong>Issue 2: Misalignment During Coregistration</strong>
						<p><strong>Solution:</strong> Check the coregistration parameters and ensure that the anatomical and functional images are correctly oriented. Using a higher resolution anatomical scan can improve alignment accuracy.</p>
					</li>
					<li><strong>Issue 3: Poor Spatial Normalization</strong>
						<p><strong>Solution:</strong> Verify that the brain extraction step was successful, as inaccurate brain masks can lead to poor normalization. Adjusting the normalization parameters or using a different template may also help.</p>
					</li>
					<li><strong>Issue 4: Inconsistent Results After Smoothing</strong>
						<p><strong>Solution:</strong> Ensure that the smoothing kernel size is appropriate for your data and research question. Excessive smoothing can blur important details, while insufficient smoothing may not adequately reduce noise.</p>
					</li>
					<li><strong>Issue 5: Persistent Artifacts Post-Preprocessing</strong>
						<p><strong>Solution:</strong> Identify the source of the artifacts (e.g., physiological noise, scanner issues) and apply targeted artifact removal techniques. Independent Component Analysis (ICA) is effective for removing specific types of artifacts like eye blinks in EEG data.</p>
					</li>
					<li><strong>Issue 6: Software Compatibility Issues</strong>
						<p><strong>Solution:</strong> Ensure that all software tools and libraries used are compatible with each other. Using containerized environments like Docker can help manage dependencies and avoid compatibility issues.</p>
					</li>
				</ul>

				<h2>Interactive Tutorial:</h2>

				<h3>Step 1: Install Libraries</h3>
				<pre><code>!pip install nilearn
!pip install mne
!pip install nipype</code></pre>

				<h3>Step 2: Download Dataset</h3>
				<pre><code>import os
os.system('aws s3 sync --no-sign-request s3://openneuro.org/ds000102 ds000102-download/')</code></pre>

				<h3>Step 3: Load Data</h3>
				<pre><code>import nibabel as nib
data_path = 'ds000102-download/sub-01/ses-01/func/sub-01_ses-01_task-rest_bold.nii.gz'
img = nib.load(data_path)</code></pre>

				<h3>Step 4: Preprocess Data</h3>
				<pre><code>from nilearn.image import resample_to_img
template = 'MNI152_T1_1mm_brain.nii.gz'
resampled_img = resample_to_img(img, template)</code></pre>

				<h3>Step 5: Artifact Removal</h3>
				<pre><code>from mne.preprocessing import ICA
ica = ICA(n_components=20, random_state=97)
ica.fit(raw)
raw_clean = ica.apply(raw)</code></pre>

				<h2>Resources:</h2>
				<ul>
					<li><a href="https://andysbrainbook.readthedocs.io/en/latest/OpenScience/OS/fMRIPrep_Demo.html">Andy's Brain Book on fMRIPrep</a></li>
					<li><a href="https://rpubs.com/sarenseeley/bids-fmriprep-mriqc">BIDS fMRIPrep and MRIQC</a></li>
				</ul>

				<h2>References:</h2>
				<ul>
					<li>Provins, C., MacNicol, E., Seeley, S. H., Hagmann, P., & Esteban, O. (2023). Quality control in functional MRI studies with MRIQC and fMRIPrep. Frontiers in neuroimaging, 1, 1073734. <a href="https://doi.org/10.3389/fnimg.2022.1073734">Link</a></li>
					<li>Nárai, Á., Hermann, P., Auer, T., Kemenczky, P., Szalma, J., Homolya, I., Somogyi, E., Vakli, P., Weiss, B., & Vidnyánszky, Z. (2022). Movement-related artefacts (MR-ART) dataset of matched motion-corrupted and clean structural MRI brain scans. Scientific data, 9(1), 630. <a href="https://doi.org/10.1038/s41597-022-01694-8">Link</a></li>
					<li>Esteban, O., Birman, D., Schaer, M., Koyejo, O. O., Poldrack, R. A., & Gorgolewski, K. J. (2017). MRIQC: Advancing the automatic prediction of image quality in MRI from unseen sites. PloS one, 12(9), e0184661. <a href="https://doi.org/10.1371/journal.pone.0184661">Link</a></li>
				</ul>

				<p>By following this tutorial, you will gain essential skills and knowledge to preprocess neuroimaging data effectively, ensuring high-quality and reliable results for your research. Happy learning!</p>
			</div>
		</div>

		<!-- Footer -->
		<footer id="footer">
			<div class="inner">
				<section>
					<h2>Get in touch</h2>
					<form method="post" action="#">
						<div class="fields">
							<div class="field half">
								<input type="text" name="name" id="name" placeholder="Name" />
							</div>
							<div class="field half">
								<input type="email" name="email" id="email" placeholder="Email" />
							</div>
							<div class="field">
								<textarea name="message" id="message" placeholder="Message"></textarea>
							</div>
						</div>
						<ul class="actions">
							<li><input type="submit" value="Send" class="primary" /></li>
						</ul>
					</form>
				</section>
				<section>
					<h2>Follow</h2>
					<ul class="icons">
						<li><a href="#" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands style2 fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands style2 fa-dribbble"><span class="label">Dribbble</span></a></li>
						<li><a href="#" class="icon brands style2 fa-github"><span class="label">GitHub</span></a></li>
						<li><a href="#" class="icon brands style2 fa-500px"><span class="label">500px</span></a></li>
						<li><a href="#" class="icon solid style2 fa-phone"><span class="label">Phone</span></a></li>
						<li><a href="#" class="icon solid style2 fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</section>
				<ul class="copyright">
					<li>&copy; Untitled. All rights reserved</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
				</ul>
			</div>
		</footer>

	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

</body>
</html>
